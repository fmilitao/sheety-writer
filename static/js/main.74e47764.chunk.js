(this["webpackJsonpsheety-writer"]=this["webpackJsonpsheety-writer"]||[]).push([[0],{112:function(e,t,n){e.exports=n(179)},117:function(e,t,n){},179:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),i=n.n(o),l=(n(117),n(19)),c=n(219),s=n(227),u=n(234),d=n(97),p=n.n(d),g=n(100),f=n(238),h=n(224),v=n(88),m=n.n(v),y=Object(c.a)((function(e){return{close:{padding:e.spacing(.5)}}}));function b(e){var t=y(),n=r.a.useState(!1),a=Object(l.a)(n,2),o=a[0],i=a[1],c=r.a.useState("Hello!"),s=Object(l.a)(c,2),u=s[0],d=s[1];function p(e,t){"clickaway"!==t&&i(!1)}return e.logger.log=function(e){d(e),i(!0)},r.a.createElement(f.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:o,autoHideDuration:3e3,onClose:p,message:u,action:[r.a.createElement(h.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:p},r.a.createElement(m.a,null))]})}var E=n(240),w=n(236),S=n(228),O=n(58),C=n(27),I=n.n(C),j=n(39),k=n(226),P=n(235);function N(e){return r.a.createElement(P.a,{id:"date",label:"Date",type:"date",fullWidth:!0,value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},InputLabelProps:{shrink:!0}})}var x=n(241),W=n(89);function D(e){return r.a.createElement("div",null,r.a.createElement(x.a,{shrink:!0,htmlFor:"age-native-label-placeholder"},"Type"),r.a.createElement(W.a,{fullWidth:!0,value:e.value,onChange:function(t){return e.onChange(t.target.value)}},r.a.createElement("option",{value:"",key:-1},"- None -"),e.choices.map((function(e,t){return r.a.createElement("option",{value:e,key:t},e)}))))}function R(e){return r.a.createElement(P.a,{id:"standard-number",label:"Amount",placeholder:"How much was spent...",value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},type:"number",fullWidth:!0,InputLabelProps:{shrink:!0},margin:"normal"})}function A(e){return r.a.createElement(P.a,{id:"standard-full-width",label:"Comment",value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},type:"text",placeholder:"What you spent money on...",fullWidth:!0,margin:"normal",InputLabelProps:{shrink:!0}})}var F=n(99),J=n(98),L=n(24),T=n(225),V=n(180),G=n(242),K=Object(c.a)((function(e){return Object(E.a)({root:{flexGrow:1},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{color:e.palette.text.hint,position:"absolute",left:2,bottom:6,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:e.spacing(2)}})}));function q(e){var t=e.inputRef,n=Object(F.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},n))}var U={Control:function(e){var t=e.children,n=e.innerProps,a=e.innerRef,o=e.selectProps,i=o.classes,l=o.TextFieldProps;return r.a.createElement(P.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:q,inputProps:Object(j.a)({className:i.input,ref:a,children:t},n)}},l))},Menu:function(e){return r.a.createElement(V.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},NoOptionsMessage:function(e){return r.a.createElement(g.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(G.a,Object.assign({ref:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(g.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(g.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}};function z(e){var t=e.suggestions.map((function(e){return{value:e,label:e}})),n=K(),a=Object(L.a)();var o={input:function(e){return Object(j.a)({},e,{color:a.palette.text.primary,"& input":{font:"inherit"}})}},i=e.value?{label:e.value,value:e.value}:null;return r.a.createElement("div",{className:n.root},r.a.createElement(T.a,null,r.a.createElement(J.a,{classes:n,styles:o,inputId:"react-select-single",TextFieldProps:{label:"Type",InputLabelProps:{htmlFor:"react-select-single",shrink:!0}},placeholder:"Expense type...",isClearable:!0,options:t,components:U,value:i,onChange:function(t){null!==t&&void 0!==t?e.onChange(t.value):e.onChange(void 0)}})))}var Y=n(68),B=n.n(Y),H=n(91),Z=n.n(H);var M=n(92),Q=new URL(window.location.href);function X(){return function(e){return null!==e&&"true"===e.toLowerCase()}(Q.searchParams.get("debug"))}function $(e){var t=function(){var e=Q.searchParams.get("config");return null===e?M:e}();if("string"===typeof t){try{return{valid:!0,value:JSON.parse(t)}}catch(n){if(e)try{return{valid:!0,value:function(e,t){var n=B.a.AES.decrypt(e,t);return JSON.parse(n.toString(B.a.enc.Utf8))}(t,e)}}catch(a){}}return{valid:!1}}return{valid:!0,value:t}}function _(e){var t=$(e);if(!t.valid)return{valid:!1};var n=function(e){var t=new Z.a({allErrors:!0}).compile({title:"GApiData",type:"object",properties:{apiKey:{type:"string"},clientId:{type:"string"},spreadsheetId:{type:"string"},sheetData:{type:"array",minItems:1,items:{type:"object",required:["title","headers"],properties:{title:{type:"string"},headers:{type:"array",minItems:1,items:{type:"object",required:["title"],properties:{title:{type:"string"},values:{type:"array",items:{type:"string"}}}}}}}}},additionalProperties:!1,required:["apiKey","clientId","spreadsheetId","sheetData"]});return t(e)?{valid:!0,value:e}:{valid:!1,errors:t.errors}}(t.value);return n.valid?{valid:!0,value:n.value}:{valid:!1}}var ee=["https://sheets.googleapis.com/$discovery/rest?version=v4"];function te(e,t,n){function a(){return I.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,I.a.awrap(gapi.client.init({apiKey:e,clientId:t,discoveryDocs:ee,scope:"https://www.googleapis.com/auth/spreadsheets"}));case 3:gapi.auth2.getAuthInstance().isSignedIn.listen(n),n(gapi.auth2.getAuthInstance().isSignedIn.get()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(JSON.stringify(a.t0,null,2));case 10:case"end":return a.stop()}}),null,null,[[0,7]])}var r=document.createElement("script");r.src="https://apis.google.com/js/client.js",r.onload=function(){gapi.load("client:auth2",a)},document.body.appendChild(r)}function ne(){gapi.auth2.getAuthInstance().signIn()}function ae(){gapi.auth2.getAuthInstance().signOut()}function re(e,t,n){var a;return I.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,I.a.awrap(gapi.client.sheets.spreadsheets.values.append({spreadsheetId:e,range:"".concat(t),valueInputOption:"USER_ENTERED",resource:{values:[n]}}));case 2:return a=r.sent,r.abrupt("return",{response:a,updatedRange:a.result.updates.updatedRange,updatedRows:a.result.updates.updatedRows});case 4:case"end":return r.stop()}}))}var oe=Object(c.a)((function(){return{root:{padding:24},button:{marginTop:"30px"}}}));function ie(e,t){var n=Array.from({length:e.length}).fill(void 0);return e.forEach((function(e,a){var r=e.title,o=t[a];o&&(/date/i.test(r)?n[a]=function(e){var t=new Date(e),n="".concat(t.getFullYear()).padStart(4,"0"),a="".concat(t.getMonth()+1).padStart(2,"0"),r="".concat(t.getDate()).padStart(2,"0");return"".concat(r,"/").concat(a,"/").concat(n)}(o):n[a]=o)})),n}function le(e){var t=oe(),n={};e.elements.forEach((function(e,t){var a=e.title;/date/i.test(a)?n[t]=function(){var e=new Date,t="".concat(e.getFullYear()).padStart(4,"0"),n="".concat(e.getMonth()+1).padStart(2,"0"),a="".concat(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}():n[t]=""}));var a=r.a.useState(Object(j.a)({},n)),o=Object(l.a)(a,2),i=o[0],c=o[1],s=function(e){return function(t){c((function(n){return Object(j.a)({},n,Object(O.a)({},e,String(t)))}))}};return r.a.createElement("div",{className:t.root},e.elements.map((function(e,t){var n={key:t,value:i[t],onChange:s(t)};return/date/i.test(e.title)?r.a.createElement(N,n):/amount/i.test(e.title)?r.a.createElement(R,n):/comment/i.test(e.title)?r.a.createElement(A,n):/type/i.test(e.title)?r.a.createElement(D,Object.assign({},n,{choices:e.values||[]})):/text/i.test(e.title)?r.a.createElement(z,Object.assign({},n,{suggestions:e.values||[]})):r.a.createElement(g.a,{key:t},'Cannot build widget for "',e.title,'"')})),e.isSignedIn?r.a.createElement(k.a,{fullWidth:!0,size:"large",variant:"contained",color:"secondary",className:t.button,onClick:function(){return function(){var t,a;return I.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=ie(e.elements,i),console.log(JSON.stringify([e.spreadsheetId,e.sheet,t],null,2)),X()){r.next=8;break}return r.next=5,I.a.awrap(re(e.spreadsheetId,e.sheet,t));case 5:a=r.sent,console.log(a),e.logger.log("Updated: ".concat(a.updatedRange));case 8:c(Object(j.a)({},n));case 9:case"end":return r.stop()}}))}()}},"submit"):r.a.createElement(k.a,{disabled:!0,fullWidth:!0,size:"large",variant:"contained",color:"secondary",className:t.button},"You must sign in to submit"))}var ce=Object(c.a)((function(e){return Object(E.a)({root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper}})}));function se(e){var t=ce(),n=r.a.useState(0),a=Object(l.a)(n,2),o=a[0],i=a[1];return r.a.createElement("div",{className:t.root},r.a.createElement(s.a,{position:"static",color:"default"},r.a.createElement(w.a,{value:o,onChange:function(e,t){return i(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},e.sheets.map((function(e,t){var n=e.title;return r.a.createElement(S.a,{label:n,key:t})})))),e.sheets.map((function(t,n){var a=t.headers,i=t.title;return o===n&&r.a.createElement(le,{isSignedIn:e.isSignedIn,spreadsheetId:e.spreadsheetId,logger:e.logger,elements:a,sheet:i,key:n})})))}var ue=n(93),de=n.n(ue),pe=n(94),ge=n.n(pe),fe=n(229);function he(e,t,n){he.loaded||(he.loaded=!0,te(e,t,n))}function ve(e){r.a.useEffect((function(){return he(e.apiKey,e.clientId,e.onSignIn)}),[e.apiKey,e.clientId,e.onSignIn]);var t=r.a.createElement(h.a,{onClick:ne,title:"Sign In",color:"inherit"},r.a.createElement(fe.a,{badgeContent:"1",color:"secondary"},r.a.createElement(de.a,null))),n=r.a.createElement(h.a,{onClick:ae,title:"Sign Out",color:"inherit"},r.a.createElement(ge.a,null));return r.a.createElement("div",null,e.isSignedIn?n:t)}he.loaded=!1;var me=n(239),ye=n(233),be=n(231),Ee=n(232),we=n(230),Se=n(95),Oe=n.n(Se),Ce=n(96),Ie=n.n(Ce);function je(e){var t=r.a.useState(!e.isValid),n=Object(l.a)(t,2),a=n[0],o=n[1],i=e.isValidPassword(""),c=r.a.useState(i),s=Object(l.a)(c,2),u=s[0],d=s[1],p=r.a.useState(""),g=Object(l.a)(p,2),f=g[0],v=g[1];function m(t){o(!1),t&&e.onValue(f),v("")}return r.a.createElement("div",null,r.a.createElement(h.a,{onClick:function(){v(""),o(!0)},title:"Set unlock secret",color:"inherit"},e.isValid?r.a.createElement(Ie.a,null):r.a.createElement(fe.a,{badgeContent:"1",color:"secondary"},r.a.createElement(Oe.a,null))),r.a.createElement(me.a,{open:a,onClose:function(){return m(!1)}},r.a.createElement(we.a,null,"Set unlock secret"),r.a.createElement(be.a,null,r.a.createElement(Ee.a,null,"Set the secret to decrypt the API key and sheet id."),r.a.createElement(P.a,{error:!u,autoFocus:!0,margin:"dense",label:"Unlock secret",type:"text",onChange:function(t){var n=t.target.value;v(n),d(e.isValidPassword(n))},fullWidth:!0,value:f})),r.a.createElement(ye.a,null,r.a.createElement(k.a,{onClick:function(){return m(!1)},color:"primary"},"Cancel"),r.a.createElement(k.a,{onClick:function(){return m(!0)},color:"primary"},"Set"))))}var ke=n(69),Pe=Object(c.a)((function(){return{root:{flexGrow:1},title:{flexGrow:1,whiteSpace:"nowrap",paddingRight:10},subtitle:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"bold"},failure:{padding:24,fontStyle:"italic"}}}));var Ne=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function xe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement((function(){var e=Pe(),t=localStorage.getItem("config-secret")||"",n=r.a.useState(_(t)),a=Object(l.a)(n,2),o=a[0],i=a[1],c=r.a.useState(o.valid),d=Object(l.a)(c,2),f=d[0],h=d[1],v=r.a.useState(!0),m=Object(l.a)(v,2),y=m[0],E=m[1],w=r.a.useState(!1),S=Object(l.a)(w,2),O=S[0],C=S[1],j=r.a.useState(""),k=Object(l.a)(j,2),P=k[0],N=k[1];window.addEventListener("online",(function(){return E(!0)})),window.addEventListener("offline",(function(){return E(!1)}));var x={log:function(e){return console.log(e)}};return r.a.createElement("div",{className:e.root},r.a.createElement(s.a,{position:"static"},r.a.createElement(u.a,null,r.a.createElement(g.a,{variant:"h6",className:e.title,onClick:function(){return x.log("".concat(ke.a,": ").concat(ke.b))}},"Sheety Writer"),P&&r.a.createElement(g.a,{className:e.subtitle},P),!y&&r.a.createElement(p.a,null),o.valid&&r.a.createElement(ve,{isSignedIn:O,onSignIn:function(e){C(e),function(e){var t;return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I.a.awrap(gapi.client.sheets.spreadsheets.get({spreadsheetId:e}));case 2:return t=n.sent,n.abrupt("return",String(t.result.properties.title));case 4:case"end":return n.stop()}}))}(o.value.spreadsheetId).then((function(e){return N(e)}))},apiKey:o.value.apiKey,clientId:o.value.clientId}),!o.valid&&r.a.createElement(je,{isValid:f,onValue:function(e){var t=_(e);i(t),h(t.valid),t.valid&&localStorage.setItem("config-secret",e)},isValidPassword:function(e){return _(e).valid}}))),o.valid?r.a.createElement(se,{isSignedIn:O,spreadsheetId:o.value.spreadsheetId,sheets:o.value.sheetData,logger:x}):r.a.createElement(g.a,{className:e.failure,variant:"h6"},"Invalid, or encrypted, config file."),r.a.createElement(b,{logger:x}))}),null),document.getElementById("root")),X()?"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})):function(e){if("serviceWorker"in navigator){if(new URL("/sheety-writer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/sheety-writer","/service-worker.js");Ne?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):xe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):xe(t,e)}))}}()},69:function(e){e.exports=JSON.parse('{"a":"sheety-writer","b":"0.1.1"}')},92:function(e){e.exports=JSON.parse('"U2FsdGVkX18viRPGS0MxLA1t7dhFDTbT7OCTFDaRoGe0C/ko5JN0hRNHco9JY2/afja2BlpJwbaPApgNrrgFcSFvftSR/AbgQxl4xiNw3e9b4SfsejFxpNAgnE6ONgj8IzpccCPuGK4Z3sD8CPDQgrnfirbdvY0PVJIRJalQ4V3D533ktRupUNoeyZocK/D75lyCctJGqRttN3PC761023Ex0kdskafflHNJ9z4CmeI/8+H576pAT7HNNHrZ1a8HYjnDPLWE/g+zjTOuPrsDFvMlK1kWIGDBy9ZHt7MHgYGTR5lfF8SSL1ITxa4y2uNp6H0a4h6G9De3U9yqSxX2pPaije1L3opWC/urvkfeWcyAN3N3bKswlSfq8zoCPo9FDbSJ3MnfeGeUR6lFGQua+eyPJ/6AeCoGd4BsTvhYV/0OrWW8OcqD6bldjc9KeHn/miJSBXGmH6GGwxWudyLIydCcX6FNFZxVNlJuPdrN/DTLNcQiErk/VMthcTLkiFEyRcoPLgxdhO0OcdbPn19TPwq2wmCJvms4/RqZ6UjKBokgx401EGuoPVyMfXNeDHEjeCaPEDHY4N/iERkuyHgybb9g7DuRLtI2LUrgOngWehEjYq/PMjyfkXwWWhYsZhUusw4SMaGNjYBwMcwkO1I5uTZYe1Z7ih2FbQsU2A/7nyRBSjzylOUfY3eXm1jJ0Dyuf6zuA8QeKEVwWH4AAZ9SY/Tx9pjoo8D/62KW87hKe/R9qi8XbgEh1CJpRzg3rdhEeCNWauTW4KsgROFWUTsV2coy2IG2B4MioUjCIUyFQgQpoYWKir0vlQxZVWCOF3S1cPhy36UlWQq1oxMFPM+OhEiJsz08mE/6Kd8jNSzE04En1DRZA1BSCmgSR3menjsqPF38K1ZYvl0DiqFO6xc2CS4OPk5enBRDrzEXZHYeFh+cWNKpZ6/lfk8aXairZ28pIke15F8T+2flNJrpMzDcQJoVgFAjedxvhPm+hozt/LpChZPTNdCnZSnBjnLiLOQKO7dIn/RC1Thq+LL4u7LVJVkpn2IrYD/RG6XPI4I9q0zBNp4NUWKaS8HNNqabDTBXSmH6Suak2YPNs3WLXI2q8gKY9KBSqkUzaZtq+uUA1EQDc2drf9yeRhQ8ECHz62nAZmM/lVfX8XQgBtuDDJcsnp5lOuBMyrdOpdnQhx5BaOEtfvcIb2pjNLT/A4JCaZ27BnUUPVD1pinNNI8iozTxGiSSandzWqYQrWqOfxwDJB7uI6jI2O5TCAkFzdh+AsE6jz0VY3WCfPeG71syolaiyHKELulk02fy+J73wg73bgwGauo+RIBzPV5TE3mGA4FwQagEqa1gossuvxdnYji8s587qAPEr3G8Y0sFOxIKW6wCmDqvqCAs1VgmA1R+V19CDZLEnZGFDSKCxnPiJGPjmyj0kjre6ua+HcBOom3VqmsDU65Lm9KCnjl1BvO/0YSJwlbyhopZMxS2/004D6h6LA"')}},[[112,1,2]]]);
//# sourceMappingURL=main.74e47764.chunk.js.map