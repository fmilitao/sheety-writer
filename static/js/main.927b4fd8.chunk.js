(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){e.exports=n(173)},108:function(e,t,n){},173:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),i=n.n(o),l=(n(108),n(20)),c=n(213),s=n(219),u=n(226),d=n(92),p=n.n(d),f=n(95),g=n(231),v=n(216),h=n(84),m=n.n(h),y=Object(c.a)(function(e){return{close:{padding:e.spacing(.5)}}});function b(e){var t=y(),n=r.a.useState(!1),a=Object(l.a)(n,2),o=a[0],i=a[1],c=r.a.useState("Hello!"),s=Object(l.a)(c,2),u=s[0],d=s[1];function p(e,t){"clickaway"!==t&&i(!1)}return e.logger.log=function(e){d(e),i(!0)},r.a.createElement(g.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:o,autoHideDuration:3e3,onClose:p,message:u,action:[r.a.createElement(v.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:p},r.a.createElement(m.a,null))]})}var E=n(233),w=n(228),S=n(220),O=n(54),I=n(29),j=n.n(I),C=n(46),k=n(34),x=n(218),P=n(227);function N(e){return r.a.createElement(P.a,{id:"date",label:"Date",type:"date",fullWidth:!0,value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},InputLabelProps:{shrink:!0}})}function W(e){return r.a.createElement(P.a,{id:"standard-number",label:"Amount",placeholder:"How much was spent...",value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},type:"number",fullWidth:!0,InputLabelProps:{shrink:!0},margin:"normal"})}function q(e){return r.a.createElement(P.a,{id:"standard-full-width",label:"Comment",value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},type:"text",placeholder:"What you spent money on...",fullWidth:!0,margin:"normal",InputLabelProps:{shrink:!0}})}var A=n(94),M=n(93),D=n(52),L=n(217),R=n(174),z=n(232),G=Object(c.a)(function(e){return Object(E.a)({root:{flexGrow:1},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{color:e.palette.text.hint,position:"absolute",left:2,bottom:6,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:e.spacing(2)}})});function T(e){var t=e.inputRef,n=Object(A.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},n))}var U={Control:function(e){var t=e.children,n=e.innerProps,a=e.innerRef,o=e.selectProps,i=o.classes,l=o.TextFieldProps;return r.a.createElement(P.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:T,inputProps:Object(k.a)({className:i.input,ref:a,children:t},n)}},l))},Menu:function(e){return r.a.createElement(R.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},NoOptionsMessage:function(e){return r.a.createElement(f.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(z.a,Object.assign({ref:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(f.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(f.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}};function F(e){var t=e.suggestions.map(function(e){return{value:e,label:e}}),n=G(),a=Object(D.a)();var o={input:function(e){return Object(k.a)({},e,{color:a.palette.text.primary,"& input":{font:"inherit"}})}},i=e.value?{label:e.value,value:e.value}:null;return r.a.createElement("div",{className:n.root},r.a.createElement(L.a,null,r.a.createElement(M.a,{classes:n,styles:o,inputId:"react-select-single",TextFieldProps:{label:"type",InputLabelProps:{htmlFor:"react-select-single",shrink:!0}},placeholder:"Type expense",isClearable:!0,options:t,components:U,value:i,onChange:function(t){null!==t&&void 0!==t?e.onChange(t.value):e.onChange(void 0)}})))}var Q=n(63),V=n.n(Q),B=n(86),J=n.n(B);var K=n(87),H=new URL(window.location.href);function Y(){return function(e){return null!==e&&"true"===e.toLowerCase()}(H.searchParams.get("debug"))}function Z(e){var t=function(){var e=H.searchParams.get("config");return null===e?K:e}();if("string"===typeof t){try{return{valid:!0,value:JSON.parse(t)}}catch(n){if(e)try{return{valid:!0,value:function(e,t){var n=V.a.AES.decrypt(e,t);return JSON.parse(n.toString(V.a.enc.Utf8))}(t,e)}}catch(a){}}return{valid:!1}}return{valid:!0,value:t}}function X(e){var t=Z(e);if(!t.valid)return{valid:!1};var n=function(e){var t=new J.a({allErrors:!0}).compile({title:"GApiData",type:"object",properties:{apiKey:{type:"string"},clientId:{type:"string"},spreadsheetId:{type:"string"},sheetData:{type:"array",minItems:1,items:{type:"object",required:["title","headers"],properties:{title:{type:"string"},headers:{type:"array",minItems:1,items:{type:"object",required:["title"],properties:{title:{type:"string"},values:{type:"array",items:{type:"string"}}}}}}}}},additionalProperties:!1,required:["apiKey","clientId","spreadsheetId","sheetData"]});return t(e)?{valid:!0,value:e}:{valid:!1,errors:t.errors}}(t.value);return n.valid?{valid:!0,value:n.value}:{valid:!1}}var $=["https://sheets.googleapis.com/$discovery/rest?version=v4"],_="https://www.googleapis.com/auth/spreadsheets";function ee(e,t,n){function a(){return r.apply(this,arguments)}function r(){return(r=Object(C.a)(j.a.mark(function a(){return j.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,gapi.client.init({apiKey:e,clientId:t,discoveryDocs:$,scope:_});case 3:gapi.auth2.getAuthInstance().isSignedIn.listen(n),n(gapi.auth2.getAuthInstance().isSignedIn.get()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(JSON.stringify(a.t0,null,2));case 10:case"end":return a.stop()}},a,null,[[0,7]])}))).apply(this,arguments)}var o=document.createElement("script");o.src="https://apis.google.com/js/client.js",o.onload=function(){gapi.load("client:auth2",a)},document.body.appendChild(o)}function te(){gapi.auth2.getAuthInstance().signIn()}function ne(){gapi.auth2.getAuthInstance().signOut()}function ae(e,t,n){return re.apply(this,arguments)}function re(){return(re=Object(C.a)(j.a.mark(function e(t,n,a){var r;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gapi.client.sheets.spreadsheets.values.append({spreadsheetId:t,range:"".concat(n),valueInputOption:"USER_ENTERED",resource:{values:[a]}});case 2:return r=e.sent,e.abrupt("return",{response:r,updatedRange:r.result.updates.updatedRange,updatedRows:r.result.updates.updatedRows});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var oe=Object(c.a)(function(){return{root:{padding:24},button:{marginTop:"30px"}}});function ie(e,t){var n=Array.from({length:e.length}).fill(void 0);return e.forEach(function(e,a){var r=e.title,o=t[a];o&&(/date/i.test(r)?n[a]=function(e){var t=new Date(e),n="".concat(t.getFullYear()).padStart(4,"0"),a="".concat(t.getMonth()+1).padStart(2,"0"),r="".concat(t.getDate()).padStart(2,"0");return"".concat(r,"/").concat(a,"/").concat(n)}(o):n[a]=o)}),n}function le(e){var t=oe(),n={};e.elements.forEach(function(e,t){var a=e.title;/date/i.test(a)?n[t]=function(){var e=new Date,t="".concat(e.getFullYear()).padStart(4,"0"),n="".concat(e.getMonth()+1).padStart(2,"0"),a="".concat(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}():n[t]=""});var a=r.a.useState(Object(k.a)({},n)),o=Object(l.a)(a,2),i=o[0],c=o[1],s=function(){var t=Object(C.a)(j.a.mark(function t(){var a,r;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=ie(e.elements,i),console.log(JSON.stringify([e.spreadsheetId,e.sheet,a],null,2)),Y()){t.next=8;break}return t.next=5,ae(e.spreadsheetId,e.sheet,a);case 5:r=t.sent,console.log(r),e.logger.log("Updated: ".concat(r.updatedRange));case 8:c(Object(k.a)({},n));case 9:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),u=function(e){return function(t){c(function(n){return Object(k.a)({},n,Object(O.a)({},e,String(t)))})}};return r.a.createElement("div",{className:t.root},e.elements.map(function(e,t){var n={key:t,value:i[t],onChange:u(t)};return/date/i.test(e.title)?r.a.createElement(N,n):/amount/i.test(e.title)?r.a.createElement(W,n):/comment/i.test(e.title)?r.a.createElement(q,n):/type/i.test(e.title)?r.a.createElement(F,Object.assign({},n,{suggestions:e.values||[]})):r.a.createElement(f.a,{key:t},'Cannot build widget for "',e.title,'"')}),e.isSignedIn?r.a.createElement(x.a,{fullWidth:!0,size:"large",variant:"contained",color:"secondary",className:t.button,onClick:function(){return s()}},"submit"):r.a.createElement(x.a,{disabled:!0,fullWidth:!0,size:"large",variant:"contained",color:"secondary",className:t.button},"You must sign in to submit"))}var ce=Object(c.a)(function(e){return Object(E.a)({root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper}})});function se(e){var t=ce(),n=r.a.useState(0),a=Object(l.a)(n,2),o=a[0],i=a[1];return r.a.createElement("div",{className:t.root},r.a.createElement(s.a,{position:"static",color:"default"},r.a.createElement(w.a,{value:o,onChange:function(e,t){return i(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},e.sheets.map(function(e,t){var n=e.title;return r.a.createElement(S.a,{label:n,key:t})}))),e.sheets.map(function(t,n){var a=t.headers,i=t.title;return o===n&&r.a.createElement(le,{isSignedIn:e.isSignedIn,spreadsheetId:e.spreadsheetId,logger:e.logger,elements:a,sheet:i,key:n})}))}var ue=n(88),de=n.n(ue),pe=n(89),fe=n.n(pe),ge=n(221);function ve(e,t,n){ve.loaded||(ve.loaded=!0,ee(e,t,n))}function he(e){r.a.useEffect(function(){return ve(e.apiKey,e.clientId,e.onSignIn)},[e.apiKey,e.clientId,e.onSignIn]);var t=r.a.createElement(v.a,{onClick:te,title:"Sign In",color:"inherit"},r.a.createElement(ge.a,{badgeContent:"1",color:"secondary"},r.a.createElement(de.a,null))),n=r.a.createElement(v.a,{onClick:ne,title:"Sign Out",color:"inherit"},r.a.createElement(fe.a,null));return r.a.createElement("div",null,e.isSignedIn?n:t)}ve.loaded=!1;var me=n(230),ye=n(225),be=n(223),Ee=n(224),we=n(222),Se=n(90),Oe=n.n(Se),Ie=n(91),je=n.n(Ie),Ce="";function ke(e){var t=r.a.useState(!e.isValid),n=Object(l.a)(t,2),a=n[0],o=n[1],i=e.isValidPassword(Ce),c=r.a.useState(i),s=Object(l.a)(c,2),u=s[0],d=s[1],p=r.a.useState(Ce),f=Object(l.a)(p,2),g=f[0],h=f[1];function m(t){o(!1),t&&e.onValue(g),h(Ce)}return r.a.createElement("div",null,r.a.createElement(v.a,{onClick:function(){h(Ce),o(!0)},title:"Set unlock secret",color:"inherit"},e.isValid?r.a.createElement(je.a,null):r.a.createElement(ge.a,{badgeContent:"1",color:"secondary"},r.a.createElement(Oe.a,null))),r.a.createElement(me.a,{open:a,onClose:function(){return m(!1)}},r.a.createElement(we.a,null,"Set unlock secret"),r.a.createElement(be.a,null,r.a.createElement(Ee.a,null,"Set the secret to decrypt the API key and sheet id."),r.a.createElement(P.a,{error:!u,autoFocus:!0,margin:"dense",label:"Unlock secret",type:"text",onChange:function(t){var n=t.target.value;h(n),d(e.isValidPassword(n))},fullWidth:!0,value:g})),r.a.createElement(ye.a,null,r.a.createElement(x.a,{onClick:function(){return m(!1)},color:"primary"},"Cancel"),r.a.createElement(x.a,{onClick:function(){return m(!0)},color:"primary"},"Set"))))}var xe="Sheety Writer",Pe=Object(c.a)(function(){return{root:{flexGrow:1},title:{flexGrow:1},failure:{padding:24,fontStyle:"italic"}}}),Ne=!0;var We=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function qe(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(function(){var e=Pe(),t=r.a.useState(X("")),n=Object(l.a)(t,2),a=n[0],o=n[1],i=r.a.useState(a.valid),c=Object(l.a)(i,2),d=c[0],g=c[1],v=r.a.useState(!0),h=Object(l.a)(v,2),m=h[0],y=h[1],E=r.a.useState(!1),w=Object(l.a)(E,2),S=w[0],O=w[1];window.addEventListener("online",function(){return y(!0)}),window.addEventListener("offline",function(){return y(!1)});var I={log:function(e){return console.log(e)}};return r.a.createElement("div",{className:e.root},r.a.createElement(s.a,{position:"static"},r.a.createElement(u.a,null,r.a.createElement(f.a,{variant:"h6",className:e.title},xe),!m&&r.a.createElement(p.a,null),a.valid&&r.a.createElement(he,{isSignedIn:S,onSignIn:function(e){O(e)},apiKey:a.value.apiKey,clientId:a.value.clientId}),(!a.valid||!Ne)&&r.a.createElement(ke,{isValid:d,onValue:function(e){var t=X(e);o(t),g(t.valid)},isValidPassword:function(e){return X(e).valid}}))),a.valid?r.a.createElement(se,{isSignedIn:S,spreadsheetId:a.value.spreadsheetId,sheets:a.value.sheetData,logger:I}):r.a.createElement(f.a,{className:e.failure,variant:"h6"},"Invalid, or encrypted, config file."),r.a.createElement(b,{logger:I}))},null),document.getElementById("root")),Y()?"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}):function(e){if("serviceWorker"in navigator){if(new URL("/sheety-writer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/sheety-writer","/service-worker.js");We?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):qe(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):qe(t,e)})}}()},87:function(e){e.exports="U2FsdGVkX19oQw4qMaSxvQ96231a+nzayDp2fM2MZ6XwtaLfzgrCWL6MNRezOtOEqruH4vqEGJUkREBsA4TIW1KYRrvBeIx1ugT9qvHQ3jpij6JhZ4QqI6E4Zqc6NlAgtjwXxQB57gGTaZj8yc/saBVQ79kBGQvUEA/qG661fEvqw0Kyia5un+xUTzDQwl0BhAO/PNQqdlFoyjrymNUS0CZcMEYyZbK0q0j4aCPqdgQnbOeQvetxpJNk0M4l+fLQWHNOyDGX0D6bBotw1XISzleMRn6c/q+SBMZ5+3Ok6OdMC+hhHmFJzt41c5zjSH1y1hNo+Z7K617jv+ooNyrN7nTqnvTxAfkqLvjaWRfnHLyd9JYNYcx5eTvOtT1RWGXVwNtLXXls0lMZEt+cDi6vMrLnxTtZNoyS0/ti7eDf09nk4iYiHeUzGTBRoty3/mIVydFxfwPsqOsqD/59BIYjvHcTcqmyuGHwt9GLC+nQ9+7rkUFPmtHtYZ90rCeJ+2Vqp+ez7ASAD0UufwnZpfLUH/uuP0wky8CBNiZLWhSw/5ACKFxUQoS50WeqkYjElxmWCJrSCyLJopBq0zvd6Jx+tPXqGb9lin5uurpfwMA69JFqxqyG/A1nPYtVyPOFKQDKqZC8mkmWIFBxvn2rxI58IrhbwanEccas17ouILOGs6db+/Qnsw5ME88cVpm5hPCeni/PxyNSM1InJmgcYtnKlmobSMTbSMRIU475G6WuU8P1zzjlO6jllKEDzWkrhlGQwsC+XMQbxL3geNdiMF6zOcD/rDthssjFYJ1lozBg/+fggjIMQyItbBF8oA61j/iA"}},[[103,1,2]]]);
//# sourceMappingURL=main.927b4fd8.chunk.js.map