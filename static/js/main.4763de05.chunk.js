(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){e.exports=n(174)},109:function(e,t,n){},174:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),o=n.n(i),l=(n(109),n(18)),c=n(214),s=n(220),u=n(227),d=n(93),p=n.n(d),g=n(96),f=n(232),h=n(217),v=n(85),m=n.n(v),b=Object(c.a)(function(e){return{close:{padding:e.spacing(.5)}}});function y(e){var t=b(),n=r.a.useState(!1),a=Object(l.a)(n,2),i=a[0],o=a[1],c=r.a.useState("Hello!"),s=Object(l.a)(c,2),u=s[0],d=s[1];function p(e,t){"clickaway"!==t&&o(!1)}return e.logger.log=function(e){d(e),o(!0)},r.a.createElement(f.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:i,autoHideDuration:3e3,onClose:p,message:u,action:[r.a.createElement(h.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:p},r.a.createElement(m.a,null))]})}var w=n(234),E=n(229),I=n(221),O=n(54),S=n(25),k=n.n(S),j=n(42),x=n(34),C=n(219),W=n(228);function P(e){return r.a.createElement(W.a,{id:"date",label:"Date",type:"date",fullWidth:!0,value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},InputLabelProps:{shrink:!0}})}function N(e){return r.a.createElement(W.a,{id:"standard-number",label:"Amount",placeholder:"How much was spent...",value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},type:"number",fullWidth:!0,InputLabelProps:{shrink:!0},margin:"normal"})}function R(e){return r.a.createElement(W.a,{id:"standard-full-width",label:"Comment",value:e.value,onChange:function(t){var n=t.target.value;e.onChange(n)},type:"text",placeholder:"What you spent money on...",fullWidth:!0,margin:"normal",InputLabelProps:{shrink:!0}})}var U=n(95),V=n(94),A=n(52),L=n(218),D=n(175),q=n(233),G=Object(c.a)(function(e){return Object(w.a)({root:{flexGrow:1},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{color:e.palette.text.hint,position:"absolute",left:2,bottom:6,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:e.spacing(2)}})});function B(e){var t=e.inputRef,n=Object(U.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},n))}var J={Control:function(e){var t=e.children,n=e.innerProps,a=e.innerRef,i=e.selectProps,o=i.classes,l=i.TextFieldProps;return r.a.createElement(W.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:B,inputProps:Object(x.a)({className:o.input,ref:a,children:t},n)}},l))},Menu:function(e){return r.a.createElement(D.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},NoOptionsMessage:function(e){return r.a.createElement(g.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(q.a,Object.assign({ref:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(g.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(g.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}};function K(e){var t=e.suggestions.map(function(e){return{value:e,label:e}}),n=G(),a=Object(A.a)();var i={input:function(e){return Object(x.a)({},e,{color:a.palette.text.primary,"& input":{font:"inherit"}})}},o=e.value?{label:e.value,value:e.value}:null;return r.a.createElement("div",{className:n.root},r.a.createElement(L.a,null,r.a.createElement(V.a,{classes:n,styles:i,inputId:"react-select-single",TextFieldProps:{label:"type",InputLabelProps:{htmlFor:"react-select-single",shrink:!0}},placeholder:"Type expense",isClearable:!0,options:t,components:J,value:o,onChange:function(t){null!==t&&void 0!==t?e.onChange(t.value):e.onChange(void 0)}})))}var T=n(63),F=n.n(T),z=n(87),H=n.n(z);var M=n(88),Q=new URL(window.location.href);function Y(){return function(e){return null!==e&&"true"===e.toLowerCase()}(Q.searchParams.get("debug"))}function X(e){var t=function(){var e=Q.searchParams.get("config");return null===e?M:e}();if("string"===typeof t){try{return{valid:!0,value:JSON.parse(t)}}catch(n){if(e)try{return{valid:!0,value:function(e,t){var n=F.a.AES.decrypt(e,t);return JSON.parse(n.toString(F.a.enc.Utf8))}(t,e)}}catch(a){}}return{valid:!1}}return{valid:!0,value:t}}function Z(e){var t=X(e);if(!t.valid)return{valid:!1};var n=function(e){var t=new H.a({allErrors:!0}).compile({title:"GApiData",type:"object",properties:{apiKey:{type:"string"},clientId:{type:"string"},spreadsheetId:{type:"string"},sheetData:{type:"array",minItems:1,items:{type:"object",required:["title","headers"],properties:{title:{type:"string"},headers:{type:"array",minItems:1,items:{type:"object",required:["title"],properties:{title:{type:"string"},values:{type:"array",items:{type:"string"}}}}}}}}},additionalProperties:!1,required:["apiKey","clientId","spreadsheetId","sheetData"]});return t(e)?{valid:!0,value:e}:{valid:!1,errors:t.errors}}(t.value);return n.valid?{valid:!0,value:n.value}:{valid:!1}}var $=["https://sheets.googleapis.com/$discovery/rest?version=v4"],_="https://www.googleapis.com/auth/spreadsheets";function ee(e,t,n){function a(){return r.apply(this,arguments)}function r(){return(r=Object(j.a)(k.a.mark(function a(){return k.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,gapi.client.init({apiKey:e,clientId:t,discoveryDocs:$,scope:_});case 3:gapi.auth2.getAuthInstance().isSignedIn.listen(n),n(gapi.auth2.getAuthInstance().isSignedIn.get()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(JSON.stringify(a.t0,null,2));case 10:case"end":return a.stop()}},a,null,[[0,7]])}))).apply(this,arguments)}var i=document.createElement("script");i.src="https://apis.google.com/js/client.js",i.onload=function(){gapi.load("client:auth2",a)},document.body.appendChild(i)}function te(){gapi.auth2.getAuthInstance().signIn()}function ne(){gapi.auth2.getAuthInstance().signOut()}function ae(e,t,n){return re.apply(this,arguments)}function re(){return(re=Object(j.a)(k.a.mark(function e(t,n,a){var r;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gapi.client.sheets.spreadsheets.values.append({spreadsheetId:t,range:"".concat(n),valueInputOption:"USER_ENTERED",resource:{values:[a]}});case 2:return r=e.sent,e.abrupt("return",{response:r,updatedRange:r.result.updates.updatedRange,updatedRows:r.result.updates.updatedRows});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ie(){return(ie=Object(j.a)(k.a.mark(function e(t){var n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gapi.client.sheets.spreadsheets.get({spreadsheetId:t});case 2:return n=e.sent,e.abrupt("return",String(n.result.properties.title));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var oe=Object(c.a)(function(){return{root:{padding:24},button:{marginTop:"30px"}}});function le(e,t){var n=Array.from({length:e.length}).fill(void 0);return e.forEach(function(e,a){var r=e.title,i=t[a];i&&(/date/i.test(r)?n[a]=function(e){var t=new Date(e),n="".concat(t.getFullYear()).padStart(4,"0"),a="".concat(t.getMonth()+1).padStart(2,"0"),r="".concat(t.getDate()).padStart(2,"0");return"".concat(r,"/").concat(a,"/").concat(n)}(i):n[a]=i)}),n}function ce(e){var t=oe(),n={};e.elements.forEach(function(e,t){var a=e.title;/date/i.test(a)?n[t]=function(){var e=new Date,t="".concat(e.getFullYear()).padStart(4,"0"),n="".concat(e.getMonth()+1).padStart(2,"0"),a="".concat(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}():n[t]=""});var a=r.a.useState(Object(x.a)({},n)),i=Object(l.a)(a,2),o=i[0],c=i[1],s=function(){var t=Object(j.a)(k.a.mark(function t(){var a,r;return k.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=le(e.elements,o),console.log(JSON.stringify([e.spreadsheetId,e.sheet,a],null,2)),Y()){t.next=8;break}return t.next=5,ae(e.spreadsheetId,e.sheet,a);case 5:r=t.sent,console.log(r),e.logger.log("Updated: ".concat(r.updatedRange));case 8:c(Object(x.a)({},n));case 9:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),u=function(e){return function(t){c(function(n){return Object(x.a)({},n,Object(O.a)({},e,String(t)))})}};return r.a.createElement("div",{className:t.root},e.elements.map(function(e,t){var n={key:t,value:o[t],onChange:u(t)};return/date/i.test(e.title)?r.a.createElement(P,n):/amount/i.test(e.title)?r.a.createElement(N,n):/comment/i.test(e.title)?r.a.createElement(R,n):/type/i.test(e.title)?r.a.createElement(K,Object.assign({},n,{suggestions:e.values||[]})):r.a.createElement(g.a,{key:t},'Cannot build widget for "',e.title,'"')}),e.isSignedIn?r.a.createElement(C.a,{fullWidth:!0,size:"large",variant:"contained",color:"secondary",className:t.button,onClick:function(){return s()}},"submit"):r.a.createElement(C.a,{disabled:!0,fullWidth:!0,size:"large",variant:"contained",color:"secondary",className:t.button},"You must sign in to submit"))}var se=Object(c.a)(function(e){return Object(w.a)({root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper}})});function ue(e){var t=se(),n=r.a.useState(0),a=Object(l.a)(n,2),i=a[0],o=a[1];return r.a.createElement("div",{className:t.root},r.a.createElement(s.a,{position:"static",color:"default"},r.a.createElement(E.a,{value:i,onChange:function(e,t){return o(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},e.sheets.map(function(e,t){var n=e.title;return r.a.createElement(I.a,{label:n,key:t})}))),e.sheets.map(function(t,n){var a=t.headers,o=t.title;return i===n&&r.a.createElement(ce,{isSignedIn:e.isSignedIn,spreadsheetId:e.spreadsheetId,logger:e.logger,elements:a,sheet:o,key:n})}))}var de=n(89),pe=n.n(de),ge=n(90),fe=n.n(ge),he=n(222);function ve(e,t,n){ve.loaded||(ve.loaded=!0,ee(e,t,n))}function me(e){r.a.useEffect(function(){return ve(e.apiKey,e.clientId,e.onSignIn)},[e.apiKey,e.clientId,e.onSignIn]);var t=r.a.createElement(h.a,{onClick:te,title:"Sign In",color:"inherit"},r.a.createElement(he.a,{badgeContent:"1",color:"secondary"},r.a.createElement(pe.a,null))),n=r.a.createElement(h.a,{onClick:ne,title:"Sign Out",color:"inherit"},r.a.createElement(fe.a,null));return r.a.createElement("div",null,e.isSignedIn?n:t)}ve.loaded=!1;var be=n(231),ye=n(226),we=n(224),Ee=n(225),Ie=n(223),Oe=n(91),Se=n.n(Oe),ke=n(92),je=n.n(ke),xe="";function Ce(e){var t=r.a.useState(!e.isValid),n=Object(l.a)(t,2),a=n[0],i=n[1],o=e.isValidPassword(xe),c=r.a.useState(o),s=Object(l.a)(c,2),u=s[0],d=s[1],p=r.a.useState(xe),g=Object(l.a)(p,2),f=g[0],v=g[1];function m(t){i(!1),t&&e.onValue(f),v(xe)}return r.a.createElement("div",null,r.a.createElement(h.a,{onClick:function(){v(xe),i(!0)},title:"Set unlock secret",color:"inherit"},e.isValid?r.a.createElement(je.a,null):r.a.createElement(he.a,{badgeContent:"1",color:"secondary"},r.a.createElement(Se.a,null))),r.a.createElement(be.a,{open:a,onClose:function(){return m(!1)}},r.a.createElement(Ie.a,null,"Set unlock secret"),r.a.createElement(we.a,null,r.a.createElement(Ee.a,null,"Set the secret to decrypt the API key and sheet id."),r.a.createElement(W.a,{error:!u,autoFocus:!0,margin:"dense",label:"Unlock secret",type:"text",onChange:function(t){var n=t.target.value;v(n),d(e.isValidPassword(n))},fullWidth:!0,value:f})),r.a.createElement(ye.a,null,r.a.createElement(C.a,{onClick:function(){return m(!1)},color:"primary"},"Cancel"),r.a.createElement(C.a,{onClick:function(){return m(!0)},color:"primary"},"Set"))))}var We=n(64),Pe="Sheety Writer",Ne=Object(c.a)(function(){return{root:{flexGrow:1},title:{flexGrow:1,whiteSpace:"nowrap",paddingRight:10},subtitle:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"bold"},failure:{padding:24,fontStyle:"italic"}}}),Re=!0,Ue="config-secret";var Ve=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ae(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(function(){var e=Ne(),t=localStorage.getItem(Ue)||"",n=r.a.useState(Z(t)),a=Object(l.a)(n,2),i=a[0],o=a[1],c=r.a.useState(i.valid),d=Object(l.a)(c,2),f=d[0],h=d[1],v=r.a.useState(!0),m=Object(l.a)(v,2),b=m[0],w=m[1],E=r.a.useState(!1),I=Object(l.a)(E,2),O=I[0],S=I[1],k=r.a.useState(""),j=Object(l.a)(k,2),x=j[0],C=j[1];window.addEventListener("online",function(){return w(!0)}),window.addEventListener("offline",function(){return w(!1)});var W={log:function(e){return console.log(e)}};return r.a.createElement("div",{className:e.root},r.a.createElement(s.a,{position:"static"},r.a.createElement(u.a,null,r.a.createElement(g.a,{variant:"h6",className:e.title,onClick:function(){return W.log("".concat(We.a,": ").concat(We.b))}},Pe),x&&r.a.createElement(g.a,{className:e.subtitle},x),!b&&r.a.createElement(p.a,null),i.valid&&r.a.createElement(me,{isSignedIn:O,onSignIn:function(e){S(e),function(e){return ie.apply(this,arguments)}(i.value.spreadsheetId).then(function(e){return C(e)})},apiKey:i.value.apiKey,clientId:i.value.clientId}),(!i.valid||!Re)&&r.a.createElement(Ce,{isValid:f,onValue:function(e){var t=Z(e);o(t),h(t.valid),t.valid&&localStorage.setItem(Ue,e)},isValidPassword:function(e){return Z(e).valid}}))),i.valid?r.a.createElement(ue,{isSignedIn:O,spreadsheetId:i.value.spreadsheetId,sheets:i.value.sheetData,logger:W}):r.a.createElement(g.a,{className:e.failure,variant:"h6"},"Invalid, or encrypted, config file."),r.a.createElement(y,{logger:W}))},null),document.getElementById("root")),Y()?"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}):function(e){if("serviceWorker"in navigator){if(new URL("/sheety-writer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/sheety-writer","/service-worker.js");Ve?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Ae(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Ae(t,e)})}}()},64:function(e){e.exports={a:"sheety-writer",b:"0.1.1"}},88:function(e){e.exports="U2FsdGVkX1/CgUuYKwSZLh6e3bV9+lac7yLA1onGq628WrbSD44UB5QhiHdCHHk8vXneA644j7ClJmc3/Hxk8LRyB/3aaI6eOyBCLqplEMBppcnQj9CXKtazitmBxIQvRTuVnWd6cAhpSA9XGtVHh0jGkfEpf9oEpOmr4qRfL+EQZ4yj7P+FSb2uIgLL0qhNDWw7spLxOdpalJKegEUeaiTcuxSmk/vjVUJ8LbI4IPmb2MY8B8I9QS+hI78M7m70FwUDsidaHLKxi0Bmgk7BO4WF9Wi0yE+7Ex/Mk+O+Bw3L1HPoQX/nqnEfcPwy3gPKF2gAGuDMKQWW0+q3jokevj1GlbnNf+dLOSXML4fdJeioG6s84DxUnM+dlKH6ye2yNrhNs6IBK+jOaPQIyXiXzQMwj1Qx3ZrGH1iNbrclQyXJZNFVYD7AIorGJK7FuzdkEjx27hITQ7Aaux6hk0guTB5wcNvw5RgYFMba1Hmtw3cOhAym66XRXMxT4E5TI89Jo4gTbhRZ7z/OwcPeWEf/hphcGRRTGpxX+Vkc52fTGUNFrVVKB4oN+PqKJOGG1wxgz41p686RXkf6twwHh12yHZ8o5TIv1BIu3KjBiXQYMLPz79kC3oeOwgVDyjbJATva9N3rHx3Ao6hCfKKV1r5vqcjn+a8t9+YVtBdVo9TBUGpLKarBUl0JJJLwl1vHpYO3yij+Lyr9eI+5f3WodDSIOM30slZFLYJR69pG5NDfcnm3tdZVYpSYln5xyg93N5dcqELml8XvgAhhHeiD2kttkWzkYdPzjdNIeaflLsJeOPmUkW2Pg9Gby0xJpgfCGp8qETWDbZzO3rrxtWU2z6jLi4mKtuo7ldY+ggh8mRsRoui/IM0uCxbbgn0p2yTFWERE8O9+UFfaPyPItcWUDtS4KGqU4WAW/Lx7BpjvIs+RbC+69BhlXUyEwoBUxJ/O4IKWZ73sZ1Y86BvL9Dem12l8wqpFaMOYzpGtnO/Qe/yYlVirr99G0rUQqA7ENbSzvDUxK12TQqTUIvUtVf1rxLyb5G6rIV8wyp14zFr0+6C7+gHWphotXsZHcZyKsr5ziR9JU8t2VyA7M2Xl3wYo6awcBh6FOkNxWQrH7Ub8j7We02qz13d38ABUyKRkW3o8BGkqhqVcC+oyDNhvW2tDZvt6EQAqGFvlSBHu/P9rHr73wyM6XdMrEr32Ql2//hxzD3qyzZURAo1gAO+4q0x8NG1rvp0e1cGdB7j3qYwVg0idmmYPrY6uDp3MUrw27kJDQh6zJXZkVmwR5kgxh5X6eSk3FmNqh7/ECQk2iVQiD56vWb+WCVhvwmaedpwJ1JDK6HqI1fveb+HWuRiqZmqFSeR4MnvfRYO9JrvTrYAqmF5PTI4zWSnBbvsJnVQ2vwQAxiNaCZJ1dsaxEgTnRP7GIT6WiUR7wX25b1odq6d6KwWqxSU="}},[[104,1,2]]]);
//# sourceMappingURL=main.4763de05.chunk.js.map